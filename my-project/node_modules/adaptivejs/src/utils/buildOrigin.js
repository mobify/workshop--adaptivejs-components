define(function() {

    /**
     *  Grabs the location of the build so we can reference assets
     *  with absolute urls
     */
    var cachedBuildScript;
    var getBuildOrigin = function() {
        var buildOrigin = '//localhost:8080/';

        // Find an adaptive build script
        if (!cachedBuildScript) {
            var scripts = document.getElementsByTagName('script');
            for (var i = 0; i < scripts.length; i++) {
                if (/(mobify|adaptation|loader|adaptive)(\.min)?\.js/.test(scripts[i].getAttribute('src'))) {
                    cachedBuildScript = scripts[i];
                    break;
                }
            }
        }

        if (cachedBuildScript) {
            try {
                var adaptiveBuildSrc = cachedBuildScript.getAttribute('src');
                buildOrigin = adaptiveBuildSrc.replace(/\/[^\/]*$/, '/');
            } catch (e) {
                console.error('Couldn\'t determine adaptivejs build file used. The mobify-tag may be placed incorrectly.');
            }
        }
        return buildOrigin;
    };

    return getBuildOrigin;
});
